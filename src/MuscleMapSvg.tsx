import { useEffect, useRef, type MouseEvent } from 'react'

type MuscleMapSvgProps = {
  workedGroups: Set<string>
  selectedGroups: Set<string>
  view: 'front' | 'back'
  onToggle: (group: string) => void
}

const FRONT_VIEWBOX = '0 0 725 1145'
const BACK_VIEWBOX = '0 0 731 1135'
const FRONT_SVG_URL = `${import.meta.env.BASE_URL}front.svg`
const BACK_SVG_URL = `${import.meta.env.BASE_URL}back.svg`

const CORE_PATH =
  'M13.3623 15.6714C9.00451 15.0775 2.97322 14.3196 2.97322 14.3196C2.97322 14.3196 1.29219 19.9428 0.862305 24.3196C0.314453 29.8975 0.317957 33.313 1.36235 38.8196C2.11296 42.7771 2.63432 46.1809 4.36225 49.8196C6.18109 53.6497 7.88475 56.7423 10.8018 59.8196C13.4309 62.593 18.3623 67.3196 18.3623 67.3196C18.3623 67.3196 12.9302 73.1232 10.8018 77.6451C9.04047 81.3872 8.24861 83.8284 7.86225 87.8196C7.42213 92.3661 8.35061 95.9401 9.49705 98.8196C10.9106 102.37 16.8623 104.82 16.8623 104.82C16.8623 104.82 13.1703 107.96 12.1066 111.568C11.0265 115.231 11.3623 119.82 11.3623 121.32C11.3623 122.82 12.1383 130.367 12.8623 132.32L14.7161 137.32V147.32C14.7161 147.32 14.9394 157.246 15.8623 164.32C16.8537 171.919 17.6545 176.065 19.8623 183.32C23.3623 194.82 33.8623 221.32 33.8623 221.32C33.8623 221.32 37.9565 222.834 41.8623 223.82C50.0476 225.886 55.431 225.892 63.8623 226.32C74.5489 226.862 82.1911 227.111 92.8623 226.32C102.097 225.635 118.862 222.82 118.862 222.82C118.862 222.82 119.439 211.223 120.362 203.82C121.217 196.969 122.017 193.091 123.362 186.32C124.738 179.398 125.824 175.575 127.862 168.82C130.074 161.488 131.346 157.358 134.362 150.32C135.862 146.82 136.362 143.32 136.362 143.32C136.362 143.32 139.359 141.32 141.862 136.82C143.819 133.302 143.814 130.807 144.362 126.82C145.054 121.79 145.373 118.795 144.362 113.82C143.748 110.794 142.966 109.203 141.862 106.32C141.486 105.338 140.862 103.82 140.862 103.82C140.862 103.82 144.79 97.1012 145.862 92.3196C146.754 88.3422 145.424 86.3569 144.862 82.3196C144.428 79.1984 142.598 77.2183 141.362 74.3196C139.782 70.6142 136.059 67.3196 136.059 67.3196C136.059 67.3196 138.78 64.5311 140.862 62.3196C144.376 58.5879 146.882 56.8048 149.362 52.3196C151.933 47.6713 152.649 43.7773 153.362 39.3196C154.247 33.7851 153.862 26.8196 152.862 22.3196C152.244 19.5391 151.362 15.6714 151.362 15.6714C151.362 15.6714 141.175 16.1016 136.059 16.3196C127.136 16.6998 116.73 16.7379 107.862 15.6714C98.3372 14.5258 97.8677 15.2575 89.3623 10.8196C83.8945 7.96663 78.3623 0.81958 78.3623 0.81958C78.3623 0.81958 72.6683 8.2549 67.8623 11.1049C61.3248 14.9816 58.3732 14.5078 50.8623 15.6714C45.5512 16.4942 39.0084 16.8632 33.6352 16.9761C26.739 17.121 20.1967 16.6028 13.3623 15.6714Z'
const CORE_TRANSFORM = 'translate(285 322) scale(1)'

const CHEST_PATH =
  'M140.788 34.9329C140.788 34.9329 139.874 33.5186 139.288 32.9329C137.14 30.785 132.788 27.9329 132.788 27.9329C132.788 27.9329 129.622 25.6232 127.288 24.4329C123.553 22.528 121.625 21.1214 117.788 19.4329C112.701 17.1946 109.69 16.2393 104.288 14.9329C99.6703 13.816 97.002 13.5248 92.2881 12.9329C87.8152 12.3712 85.296 11.9463 80.7881 11.9329C77.4629 11.9229 72.2881 12.4329 72.2881 12.4329C72.2881 12.4329 66.1417 13.4274 62.2881 14.4329C57.0897 15.7891 54.574 17.9732 49.2881 18.9329C44.4812 19.8056 41.6729 19.3567 36.7881 19.4329C33.6643 19.4816 29.3311 19.0965 27.7881 18.4329C26.245 17.7692 26.6286 17.945 25.2881 16.9329C22.8539 15.095 21.6312 13.8855 19.2881 11.9329C16.9449 9.98024 15.7207 8.77284 13.2881 6.93286C11.3871 5.49502 10.446 4.44492 8.28809 3.43286C6.44239 2.56725 1.28809 0.932861 1.28809 0.932861C1.28809 0.932861 6.68978 8.43628 9.28809 12.4329C14.0538 19.7632 16.6529 23.7292 20.7881 31.4329C23.8033 37.05 25.7913 40.3059 28.7881 45.9329C34.0481 55.8092 36.7949 61.4834 42.7881 70.9329C46.8493 77.3362 48.5241 81.5337 53.2881 87.4329C56.4158 91.3059 58.4773 93.2296 62.2881 96.4329C67.1084 100.485 70.411 102.172 76.2881 104.433C84.2277 107.487 89.2881 107.933 96.2881 107.933C103.288 107.933 116.379 108.872 120.788 107.933C125.197 106.994 127.791 106.517 131.788 104.433C134.285 103.131 135.803 102.431 137.788 100.433C139.164 99.0477 140.788 95.9329 140.788 95.9329M140.788 34.9329L146.288 29.9329C146.288 29.9329 151.015 26.3469 154.288 24.4329C158.738 21.8303 166.288 18.9329 166.288 18.9329C166.288 18.9329 175.347 16.1384 181.288 14.9329C186.511 13.8731 189.489 13.507 194.788 12.9329C201.206 12.2374 204.25 11.9603 210.288 12.4329C217.657 13.0096 221.882 14.9821 228.788 16.4329C234.411 17.6142 237.55 18.6328 243.288 18.9329C245.823 19.0654 247.262 19.1874 249.788 18.9329C252.57 18.6525 254.118 18.2605 256.788 17.4329C259.459 16.6052 262.126 15.0482 267.788 10.9329C269.589 9.62391 276.788 4.93286 276.788 4.93286C276.788 4.93286 261.468 30.6179 252.288 47.4329C246.261 58.4722 243.948 65.0925 236.788 75.4329C232.048 82.2777 229.618 86.4888 223.788 92.4329C219.916 96.3808 218.026 99.0818 213.288 101.933C209.156 104.419 206.463 105.249 201.788 106.433C196.646 107.735 193.583 107.616 188.288 107.933C182.051 108.307 178.53 108.224 172.288 107.933C166.019 107.64 162.327 108.141 156.288 106.433C151.995 105.218 149.299 104.685 145.788 101.933C143.504 100.142 140.788 95.9329 140.788 95.9329M140.788 34.9329V95.9329'
const CHEST_TRANSFORM = 'translate(177 194) scale(1.32)'

const BICEPS_PATH_LEFT =
  'M10.6523 13.6732C7.24959 16.0988 1.15234 20.6732 1.15234 20.6732C1.15234 20.6732 4.02264 21.3583 4.65234 21.6732C5.65234 22.1732 5.71494 22.1968 6.65234 22.6732C8.63706 23.6819 8.91459 24.2815 10.6523 25.6732C13.0331 27.5798 14.2045 28.8535 16.6523 30.6732C18.9124 32.3532 20.1827 33.32 22.6523 34.6732C25.8006 36.3982 27.8329 36.8064 31.1523 38.1732C34.4718 39.54 36.2518 40.5229 39.6523 41.6732C43.2864 42.9024 45.3773 43.4906 49.1523 44.1732C53.397 44.9407 55.8397 45.0897 60.1523 45.1732C65.6326 45.2793 68.7604 45.1587 74.1523 44.1732C77.9261 43.4834 79.9596 42.7129 83.6523 41.6732C88.1711 40.4009 95.1523 38.1732 95.1523 38.1732C95.1523 38.1732 93.9989 35.4 93.1523 33.6732C90.6011 28.4692 88.8051 25.6729 85.1523 21.1732C83.4967 19.1336 82.476 18.0641 80.6523 16.1732C77.8711 13.2894 76.274 11.6845 73.1523 9.17319C71.083 7.50844 69.9699 6.47023 67.6523 5.17319C63.7185 2.97163 61.0732 2.55531 56.6523 1.67319C52.4222 0.829131 49.9632 0.824828 45.6523 0.673191C42.9204 0.577091 41.3652 0.336342 38.6523 0.673191C35.6442 1.04671 34.0476 1.77538 31.1523 2.67319C27.376 3.84422 25.1198 4.27355 21.6523 6.17319C19.3724 7.42222 18.3002 8.45872 16.1523 9.92319C14.0045 11.3877 12.7692 12.1642 10.6523 13.6732Z'
const BICEPS_PATH_RIGHT =
  'M349.652 28.6732C347.558 32.3052 344.652 38.1732 344.652 38.1732C344.652 38.1732 348.612 39.0961 351.152 39.6732C354.663 40.4708 356.624 40.9539 360.152 41.6732C364.431 42.5455 366.826 43.0856 371.152 43.6732C375.427 44.2537 377.839 44.6142 382.152 44.6732C385.867 44.7241 387.99 44.799 391.652 44.1732C394.033 43.7664 395.328 43.3295 397.652 42.6732C402.228 41.3811 404.81 40.6111 409.152 38.6732C412.582 37.1425 414.313 35.8927 417.652 34.1732C421.146 32.3742 423.23 31.6042 426.652 29.6732C429.248 28.2086 430.619 27.2432 433.152 25.6732C436.284 23.7326 441.152 20.6732 441.152 20.6732C441.152 20.6732 438.668 19.8698 437.152 19.1732C434.199 17.8162 432.843 16.4958 430.152 14.6732C427.371 12.7891 426.047 11.378 423.152 9.6732C420.895 8.34379 419.527 7.77987 417.152 6.6732C414.457 5.41682 412.964 4.64208 410.152 3.67321C405.987 2.2381 403.532 1.64682 399.152 1.17321C395.076 0.732363 392.673 0.366568 388.652 1.17321C385.381 1.82958 383.712 2.84138 380.652 4.17321C376.408 6.02087 370.152 9.6732 370.152 9.6732C370.152 9.6732 365.135 12.1846 362.152 14.1732C359.488 15.9499 357.098 17.6732 355.652 19.1732C352.607 22.3327 351.844 24.8718 349.652 28.6732Z'
const BICEPS_TRANSFORM = 'translate(70 175) scale(1.33)'

const TRICEPS_PATH_LEFT =
  'M124.873 24.5571C129.083 24.3438 136.373 23.0571 136.373 23.0571C136.373 23.0571 129.269 27.0941 124.873 29.5571C119.907 32.3397 116.28 33.2771 110.873 35.0571C101.416 38.1704 88.373 40.0571 82.873 40.0571C77.373 40.0571 65.373 39.0571 54.873 37.0571C46.9644 35.5507 43.2243 33.8397 35.873 30.5571L35.5418 30.4092C29.4461 27.6874 25.9234 26.1145 19.873 23.0571C13.3221 19.7467 1.87305 12.5571 1.87305 12.5571C1.87305 12.5571 12.873 13.0571 20.373 11.0571C23.7322 10.1614 28.373 6.05713 28.373 6.05713C28.373 6.05713 33.6766 5.50654 36.373 5.05713C42.373 4.05713 49.873 0.557129 49.873 0.557129C49.873 0.557129 54.6252 3.01771 57.873 4.05713C63.3173 5.79946 66.6728 5.63082 72.373 6.05713C79.1882 6.56681 87.873 6.55713 87.873 6.55713C87.873 6.55713 93.3968 12.3142 98.873 16.0571C102.553 18.5721 108.198 21.4961 112.373 23.0571C115.047 24.0571 121.373 24.7345 124.873 24.5571Z'
const TRICEPS_PATH_RIGHT =
  'M357.873 24.5571C354.938 24.5642 347.873 23.5571 347.873 23.5571C347.873 23.5571 352.597 26.8707 355.873 28.5571C358.787 30.0571 361.922 31.114 365.873 32.5571C373.532 35.3549 377.852 37.0895 385.873 38.5571C393.578 39.9668 397.541 40.0571 405.373 40.0571C413.205 40.0571 417.157 39.9044 424.873 38.5571C431.638 37.3759 434.891 36.8252 441.373 34.5571C447.399 32.4487 450.642 30.3698 456.373 27.5571C462.179 24.7079 466.341 21.907 471.873 18.5571C476.459 15.7799 483.373 12.5571 483.373 12.5571H478.373C474.858 12.5571 471.632 12.6546 467.373 12.0571C462.589 11.386 460.697 10.906 455.373 9.05713C451.159 7.59356 448.939 6.3928 444.873 4.55713C441.529 3.04758 436.373 0.557129 436.373 0.557129C436.373 0.557129 430.764 2.28689 426.373 3.55713C421.958 4.8343 417.934 5.99143 413.373 6.55713C407.172 7.32623 395.873 6.55713 395.873 6.55713C395.873 6.55713 389.615 14.2323 382.873 18.0571C379.528 19.9549 376.054 21.443 372.373 22.5571C368.692 23.6712 363.589 24.5433 357.873 24.5571Z'
const TRICEPS_TRANSFORM = 'translate(40 237) scale(1.33)'

const SHOULDER_FRONT_PATH_LEFT =
  'M15.8853 4.7761C10.8497 6.28799 8.38525 7.27612 4.88525 8.77612C3.98788 9.16071 0.885254 9.7761 0.885254 9.7761C0.885254 9.7761 2.59938 12.0162 3.88525 13.2761C5.36787 14.7288 6.26704 15.4762 7.88525 16.7761C9.45255 18.0351 10.6421 18.2746 12.3853 19.2761C18.6314 22.8646 22.0536 25.0473 27.8853 29.2761C31.4899 31.89 33.1896 33.7925 36.8853 36.2761C40.0817 38.4242 41.7269 40.0728 45.3853 41.2761C49.1135 42.5024 51.4614 42.1919 55.3853 42.2761C59.0995 42.3558 61.1918 42.1769 64.8853 41.7761C70.8243 41.1317 74.0426 40.0212 79.8853 38.7761C86.7417 37.315 90.5212 36.2013 97.3853 34.7761C102.447 33.7251 105.286 33.1255 110.385 32.2761C112.919 31.8541 116.885 31.2761 116.885 31.2761C116.885 31.2761 113.028 26.3123 110.385 23.2761C108.117 20.6705 107.005 19.028 104.385 16.7761C101.058 13.9158 98.777 12.8031 94.8853 10.7761C90.2222 8.34744 87.3586 7.48155 82.3853 5.7761C77.7677 4.19262 75.1657 3.26436 70.3853 2.2761C65.95 1.3592 63.4019 1.11187 58.8853 0.776099C52.9628 0.33582 49.562 0.492156 43.7251 0.760481L43.3853 0.776099C37.1161 1.06402 33.5778 1.25708 27.3853 2.2761C22.8503 3.02236 20.2871 3.45448 15.8853 4.7761Z'
const SHOULDER_FRONT_PATH_RIGHT =
  'M281.385 21.7761C277.756 25.3953 272.885 31.7761 272.885 31.7761C272.885 31.7761 278.07 32.3482 281.385 32.7761C287.849 33.6105 291.493 34.0067 297.885 35.2761C303.599 36.4107 306.676 37.6216 312.385 38.7761C320.126 40.3414 324.488 41.6673 332.385 41.7761C338.66 41.8625 342.432 42.2614 348.385 40.2761C353.027 38.7281 355.13 36.692 359.385 34.2761C363.724 31.8126 366.19 30.4775 370.385 27.7761C375.214 24.6669 377.854 22.8045 382.385 19.2761C386.212 16.2962 391.885 11.2761 391.885 11.2761C391.885 11.2761 382.574 7.4928 376.385 5.7761C369.485 3.86209 365.476 3.27794 358.385 2.2761C352.364 1.4253 348.961 1.03723 342.885 0.776098L342.877 0.775763C338.005 0.566356 335.253 0.448071 330.385 0.776098C325.866 1.0806 323.321 1.35934 318.885 2.2761C313.079 3.47623 309.892 4.57771 304.385 6.7761C299.762 8.62194 297.107 9.63743 292.885 12.2761C287.946 15.3637 285.51 17.6628 281.385 21.7761Z'
const SHOULDER_FRONT_TRANSFORM = 'translate(165 176) scale(1)'

const SHOULDER_BACK_PATH_LEFT =
  'M5.0647 39.5286C3.03866 42.2785 0.564697 47.0286 0.564697 47.0286C0.564697 47.0286 4.11014 53.717 7.0647 57.5286C11.6356 63.4254 15.3925 65.6818 21.0647 70.5286C27.0929 75.6795 30.5556 78.5005 37.0647 83.0286C43.4703 87.4847 47.2824 89.8781 54.0647 93.5286C59.4472 96.4257 62.4025 98.2255 68.0647 100.529C75.9653 103.742 81.0944 105.028 89.5647 106.029C95.77 106.761 100.565 106.594 105.065 106.029C112.303 105.119 116.198 103.993 123.065 101.529C129.074 99.3723 132.436 98.0403 138.065 95.0286L138.186 94.9638C145.179 91.2221 149.291 89.0221 155.065 83.5286C158.778 79.9955 163.565 73.5286 163.565 73.5286C163.565 73.5286 150.936 70.2893 143.065 67.5286C137.522 65.5845 134.307 64.6779 129.065 62.0286C125 59.9745 122.87 58.5306 119.065 56.0286C113.354 52.274 103.565 46.5286 103.565 46.5286C103.565 46.5286 108.625 41.7707 111.065 39.5286C116.816 34.2438 120.668 32.0101 127.065 27.5286C134.118 22.5874 145.565 15.5286 145.565 15.5286C145.565 15.5286 139.337 11.5409 135.065 9.52858C129.813 7.0549 126.668 6.04695 121.065 4.52858C116.26 3.2266 113.484 2.78925 108.565 2.02858L108.308 1.98886C102.841 1.14338 99.6689 0.652891 94.0647 0.528583C86.8181 0.367844 82.7227 0.887367 75.5647 2.02858C67.0061 3.39309 62.2146 4.58078 54.0647 7.52858C45.9334 10.4696 41.5928 12.7747 34.0647 17.0286C26.945 21.0517 22.8992 23.3566 16.5647 28.5286C11.7508 32.4591 8.75102 34.5252 5.0647 39.5286Z'
const SHOULDER_BACK_PATH_RIGHT =
  'M451.565 33.0286C459.065 38.9496 462.065 46.5286 462.065 46.5286C462.065 46.5286 460.916 51.7523 459.065 54.5286C457.065 57.5286 450.34 64.4092 444.065 70.0286C437.635 75.7866 433.762 78.7644 426.565 83.5286C420.365 87.6326 416.551 89.3936 410.065 93.0286C403.662 96.6169 399.9 98.8534 393.065 101.529C386.494 104.1 382.824 104.617 376.065 105.529C368.515 106.547 356.565 106.029 356.565 106.029C356.565 106.029 344.968 104.29 338.065 101.529C333.065 99.5286 316.565 90.7303 314.065 89.0286C309.606 85.9936 307.261 84.0347 303.145 80.596L303.065 80.5286L298.565 73.5286C298.565 73.5286 306.844 71.579 312.065 70.0286C318.399 68.1477 321.993 67.1352 328.065 64.5286C333.923 62.0135 337.026 60.1853 342.565 57.0286C349.2 53.2468 359.065 46.5286 359.065 46.5286C359.065 46.5286 352.944 39.8297 348.565 36.0286C344.141 32.1889 341.442 30.2724 336.565 27.0286C329.506 22.334 317.565 16.5286 317.565 16.5286C317.565 16.5286 327.727 11.1898 334.565 8.52858C342.913 5.27925 347.741 3.57617 356.565 2.02858C364.088 0.709187 368.427 0.458663 376.065 0.528583C386.697 0.625917 392.867 1.01784 403.065 4.02858C412.783 6.89791 417.733 10.0603 426.565 15.0286C437.091 20.9504 445.565 28.2917 451.565 33.0286Z'
const SHOULDER_BACK_TRANSFORM = 'translate(135 174) scale(1)'

const LEGS_FRONT_PATH_LEFT =
  'M40.1026 29.6692C46.7921 18.3992 58.6026 1.66919 58.6026 1.66919L74.6026 10.1692L80.1026 38.1692L89.6021 68.6692C95.0367 88.0251 97.3042 98.7605 100.103 118.669C101.961 131.887 102.43 139.373 103.603 152.669C105.102 169.669 104.602 180.169 104.602 180.169C104.602 180.169 105.283 187.787 106.103 193.669C107.618 204.542 108.727 214.669 108.102 221.669C107.336 230.255 107.196 235.333 103.603 243.169C101.299 248.192 100.031 251.282 96.1026 255.169C92.4834 258.751 89.5688 260.548 84.6021 261.669C81.4611 262.378 80.4396 262.212 77.3903 261.716L77.1021 261.669C73.1994 261.036 70.6229 259.968 67.1021 258.169C59.9539 254.517 51.6026 245.169 51.6026 245.169C51.6026 245.169 46.3661 237.451 43.6026 232.169C39.417 224.169 35.1026 210.669 35.1026 210.669C35.1026 210.669 29.3544 219.316 23.6026 221.669C19.7689 223.238 15.1016 224.169 13.1021 222.669C11.4049 221.396 10.1021 218.669 9.10257 215.169C6.70891 206.787 4.821 202.215 3.10257 193.669C0.589077 181.169 -0.160851 164.997 1.10257 146.669C2.12251 131.873 3.69759 123.604 7.10257 109.169C11.4547 90.719 14.995 80.5322 22.6026 63.1692C28.526 49.6499 32.5687 42.3617 40.1026 29.6692Z'
const LEGS_FRONT_PATH_RIGHT =
  'M259.602 0.669189L244.102 9.16919C244.102 9.16919 243.553 12.5331 243.102 14.6692C242.31 18.4228 241.807 19.8828 240.602 24.1692C237.676 34.5758 236.487 39.9026 233.102 50.1692C229.66 60.6101 226.986 66.209 223.602 76.6692C220.845 85.193 219.418 90.0151 217.102 98.6692C213.685 111.436 211.903 118.655 209.602 131.669C208.193 139.637 207.033 144.09 206.602 152.169C206.353 156.849 206.494 159.484 206.602 164.169C206.806 172.973 207.241 183.669 208.102 186.669C209.262 190.712 212.102 196.669 212.102 196.669C212.102 196.669 211.389 203.06 211.102 207.169C210.653 213.6 210.449 214.786 210.602 219.669C210.688 222.408 210.905 225.498 211.102 226.669C211.858 231.165 211.965 233.755 213.102 238.169C213.764 240.741 214.14 242.194 215.102 244.669C216.62 248.577 217.431 250.938 220.102 254.169C221.951 256.407 223.103 257.693 225.602 259.169C228.42 260.834 230.375 261.12 233.602 261.669C237.644 262.357 240.154 262.278 244.102 261.169L244.192 261.144C247.589 260.19 249.63 259.617 252.602 257.669C256.785 254.928 258.633 252.772 262.102 249.169C265.786 245.343 267.448 242.77 270.102 238.169C273.074 233.017 273.901 229.695 276.102 224.169C278.183 218.946 281.102 210.669 281.102 210.669C281.102 210.669 282.602 213.669 284.102 215.169C285.602 216.669 287.102 217.997 288.602 218.669C292.715 220.513 295.094 222.108 299.602 222.169C302.17 222.204 304.063 221.231 306.102 219.669C307.407 218.669 308.182 217.422 309.102 214.669C311.414 207.75 312.829 203.853 314.102 196.669C315.299 189.915 315.247 186.019 315.602 179.169C316.148 168.639 316.184 162.697 315.602 152.169C315.158 144.138 314.79 139.625 313.602 131.669C311.798 119.582 309.875 112.943 306.602 101.169C302.964 88.081 300.729 80.749 295.602 68.1692C291.471 58.0327 288.65 52.5252 283.684 42.8288L283.602 42.6692C278.302 32.3216 274.933 26.727 269.102 16.6692C265.457 10.3825 259.602 0.669189 259.602 0.669189Z'
const LEGS_FRONT_TRANSFORM = 'translate(202 540) scale(1)'

const LEGS_BACK_PATH =
  'M86.0294 4.00537C102.529 1.50537 128.029 0.505371 128.029 0.505371C128.029 0.505371 133.766 2.26149 137.529 3.00537C143.495 4.18459 146.948 4.50537 153.029 4.50537C159.111 4.50537 162.518 3.92602 168.529 3.00537C173.45 2.25173 181.029 0.505371 181.029 0.505371C181.029 0.505371 194.406 1.75351 203.029 2.00537C207.128 2.12508 209.434 2.29047 213.529 2.50537C222.024 2.95121 227.083 2.96979 235.029 6.00537C242.068 8.69405 246.191 10.83 251.529 16.0054C257.929 22.2099 261.055 31.0054 262.529 35.0054C264.003 39.0054 265.995 45.0869 266.529 51.5054C267.029 57.5054 265.625 69.1891 265.029 80.5054C264.029 99.5054 261.029 115.005 261.029 115.005C261.029 115.005 273.303 135.854 279.529 150.005C285.871 164.421 292.234 184.505 293.029 188.005C295.529 199.005 298.529 208.005 300.029 226.505C301.53 245.011 301.724 255.442 302.029 274.005C302.225 285.915 302.849 292.623 302.029 304.505C301.029 319.005 297.029 328.505 297.029 328.505C297.029 328.505 310.029 355.505 311.029 365.005C312.133 375.486 308.529 387.005 305.529 400.005C303.766 407.647 303.266 412.546 299.029 419.005C296.529 422.817 295.876 425.059 292.029 427.505C289.52 429.102 288.007 429.818 285.029 430.505C282.175 431.164 280.429 431.418 277.529 431.005C274.715 430.605 273.131 430.152 270.529 429.005C267.555 427.695 266.053 426.553 263.529 424.505C259.006 420.835 256.719 418.173 254.029 413.005C251.23 407.628 250.029 398.005 250.029 398.005C250.029 398.005 250.273 401.979 250.029 404.505C249.74 407.505 247.754 414.451 244.529 420.005C241.742 424.805 240.28 428.135 235.529 431.005C231.232 433.601 223.029 434.005 223.029 434.005C223.029 434.005 218.641 426.586 216.529 421.505C213.874 415.115 212.9 411.288 211.529 404.505C210.129 397.573 209.579 393.796 209.529 386.505C209.477 378.828 210.095 374.048 211.529 366.505C212.883 359.387 214.191 355.371 216.029 348.505C218.835 338.029 221.954 332.797 223.029 322.005C224.095 311.312 222.96 305.211 222.029 294.505C221.029 283.005 224.569 276.005 224.029 274.505C219.529 262.005 215.958 252.694 211.529 239.005C208.374 229.252 206.694 223.891 203.529 214.005C198.464 198.181 189.529 173.505 189.529 173.505C189.529 173.505 180.029 150.505 176.029 141.005C170.733 128.427 169.029 116.505 164.529 108.005C160.029 99.5054 155.529 85.0054 155.529 85.0054C155.529 85.0054 152.508 91.2725 151.529 94.0054C144.803 112.79 144.728 122.375 135.529 140.005C129.529 151.505 125.921 158.789 121.029 171.505C116.029 184.505 107.807 206.066 100.529 228.505C94.5292 247.005 88.0293 269.505 88.0293 269.505C88.0293 269.505 90.4603 284.169 89.5293 294.505C89.1031 299.237 88.0293 305.172 87.0293 306.505C85.241 308.89 83.0294 312.505 83.0294 312.505C83.0294 312.505 86.801 322.521 89.0294 329.005C92.4215 338.876 95.0293 347.005 97.0294 354.505C99.4778 363.686 100.374 369.026 101.029 378.505C101.65 387.468 101.029 397.505 100.529 401.505C99.694 408.186 98.314 411.672 96.0294 418.005C93.0626 426.23 87.0294 438.505 87.0294 438.505C87.0294 438.505 80.5488 436.445 77.0294 434.005C74.4171 432.194 73.0879 430.927 71.0293 428.505C67.9706 424.907 66.8049 422.28 65.0294 418.005C62.9203 412.927 61.0294 404.505 61.0294 404.505C61.0294 404.505 58.4626 412.084 55.5293 416.005C53.7098 418.438 52.7612 419.945 50.5293 422.005C47.3696 424.922 43.5293 427.758 42.0294 428.505C38.7648 430.133 36.9174 431.144 33.0293 431.005C30.6156 430.919 28.8067 430.81 26.5294 430.005C22.9878 428.754 21.046 427.891 18.0293 425.505C15.0126 423.119 11.7742 417.833 10.0288 411.505C6.02906 397.005 0.0292823 379.505 0.529359 366.505C1.17084 349.829 14.5294 326.005 14.5294 326.005C14.5294 326.005 9.52936 305.005 9.52936 294.505C9.52936 284.005 9.01431 268.295 9.52936 251.505C9.93759 238.198 9.26586 230.702 11.0294 217.505C12.1051 209.455 12.7723 204.935 14.5294 197.005C17.629 183.017 20.1217 175.273 25.5294 162.005C29.452 152.381 32.3228 147.272 37.0294 138.005C41.3415 129.516 48.5294 116.505 48.5294 116.505C48.5294 116.505 46.0602 107.125 45.0294 101.005C43.4347 91.5391 43.4312 86.0966 43.0294 76.5054C42.6044 66.3606 42.4873 53.5054 43.0294 50.5054C44.303 43.4558 45.5577 39.5237 48.5294 33.0054C51.4744 26.5454 53.1154 22.6295 58.0294 17.5054C61.5974 13.7847 64.0211 12.0054 68.5294 9.50537C74.7943 6.03117 78.64 5.12498 86.0294 4.00537Z'
const LEGS_BACK_TRANSFORM = 'translate(210 520) scale(1)'

const BACK_MUSCLES_PATH =
  'M0.739014 41.3484C0.739014 41.3484 11.0104 39.2595 17.239 36.8484C21.8815 35.0513 28.739 31.3484 28.739 31.3484C28.739 31.3484 40.5616 33.8011 48.239 33.8484C56.3039 33.898 60.9253 32.8462 68.739 30.8484C76.0462 28.98 79.9941 27.2235 86.739 23.8484C95.3114 19.5588 98.9768 17.2731 105.739 11.3484C109.478 8.07282 114.739 1.84839 114.739 1.84839C114.739 1.84839 116.282 12.8163 117.239 19.8484C118.647 30.1918 118.57 36.1375 120.739 46.3484C123.114 57.5264 124.691 64.162 128.739 74.8484C131.682 82.6169 133.823 86.632 137.739 93.8484C142.132 101.944 145.127 106.187 150.239 113.848C155.291 121.42 158.027 125.761 163.739 132.848C167.82 137.911 170.246 140.647 174.739 145.348C177.219 147.944 182.739 152.348 182.739 152.348C182.739 152.348 190.147 146.123 194.239 141.348C200.239 134.348 206.32 127.097 213.239 117.348C217.972 110.68 220.268 106.997 224.239 99.8484C229.804 89.8293 232.362 83.7163 236.239 72.8484C239.916 62.5411 241.094 56.5279 243.239 45.8484C245.414 35.0189 246.465 29.1558 247.739 18.3484C248.496 11.9227 249.239 1.84839 249.239 1.84839C249.239 1.84839 251.239 5.84839 256.239 9.84839C260.144 12.9726 262.116 14.5173 266.239 17.3484C272.791 21.848 275.84 23.1998 283.239 26.3484C290.57 29.4681 295.414 31.8452 303.739 33.3484C310.475 34.5647 314.394 33.8107 321.239 33.8484C326.71 33.8785 329.902 32.6624 335.239 33.8484C339.739 34.8484 345.784 36.9348 352.239 38.8484C356.919 40.2358 364.739 42.3484 364.739 42.3484C364.739 42.3484 360.494 52.745 358.239 59.3484C353.446 73.3848 350.97 81.3887 344.739 94.8484C340.005 105.074 337.191 110.781 331.239 120.348C324.308 131.49 320.034 137.61 311.239 147.348C305.223 154.01 301.086 157.002 294.739 163.348C288.392 169.695 284.73 173.164 278.739 179.848C272.815 186.458 269.793 189.23 265.239 196.848C262.999 200.596 261.042 203.111 258.739 207.348C256.069 212.261 254.719 215.119 252.739 220.348C250.507 226.243 249.56 229.685 248.239 235.848C246.142 245.632 245.739 261.348 245.739 261.348C245.739 261.348 238.102 263.102 233.239 264.348C225.574 266.312 221.393 267.843 213.739 269.848C206.546 271.733 202.58 273.17 195.239 274.348C188.659 275.405 184.901 276.034 178.239 275.848C170.121 275.623 165.658 274.152 157.739 272.348C146.779 269.853 140.192 266.375 129.239 263.848C123.044 262.42 115.739 261.348 115.739 261.348C115.739 261.348 116.703 258.726 117.239 256.848C118.239 253.348 118.721 246.801 118.239 240.348C117.974 236.795 117.878 234.827 117.239 231.348C115.777 223.39 113.681 219.171 110.239 211.848C104.849 200.379 100.241 194.675 92.239 184.848C85.3167 176.348 74.739 166.848 67.739 160.348C61.049 154.136 57.9857 149.942 52.239 142.848C45.1091 134.047 41.0812 129.052 35.239 119.348C29.2936 109.473 26.9795 103.356 22.239 92.8484M0.739014 41.3484C0.739014 41.3484 4.17417 48.0121 6.23901 52.3484M0.739014 41.3484L6.23901 52.3484M22.239 92.8484C15.2454 77.3473 13.5502 67.7023 6.23901 52.3484M22.239 92.8484L6.23901 52.3484'
const BACK_MUSCLES_TRANSFORM = 'translate(185 248) scale(0.99)'

const BACK_MUSCLES_FRONT_PATH =
  'M16.1484 13.7532C10.2861 16.5395 0.648438 19.2532 0.648438 19.2532L13.6484 56.2532C13.6484 56.2532 20.333 71.8178 25.6484 81.2532C30.9117 90.5961 40.6484 104.253 40.6484 104.253L60.6484 131.253C60.6484 131.253 55.8928 114.917 55.1484 104.253C54.6045 96.4616 54.6484 93.0637 54.6484 85.2532C54.6484 77.8332 55.1876 72.6588 55.6484 65.2532C56.3482 54.0071 59.6484 36.7532 59.6484 36.7532L47.1484 18.2532L37.1484 0.753174C37.1484 0.753174 24.8598 9.61271 16.1484 13.7532Z'
const BACK_MUSCLES_FRONT_PATH_RIGHT =
  'M339.148 11.7532C346.583 15.2421 359.148 18.2532 359.148 18.2532C359.148 18.2532 355.943 31.1296 353.648 38.2532C350.691 47.434 348.701 52.5005 344.648 61.2532C340.354 70.5301 337.412 75.4895 332.148 84.2532C325.847 94.7455 322.151 100.583 314.648 110.253C308.962 117.582 299.148 128.253 299.148 128.253C299.148 128.253 302.666 113.712 304.148 104.253C305.547 95.3271 305.794 90.787 305.648 81.7532C305.522 73.8829 304.947 68.5166 303.648 60.7532C302.132 51.6873 299.148 38.2532 299.148 38.2532C299.148 38.2532 307.413 26.275 312.148 18.2532C316.102 11.5568 321.648 0.753174 321.648 0.753174C321.648 0.753174 331.841 8.32393 339.148 11.7532Z'
const BACK_MUSCLES_FRONT_TRANSFORM = 'translate(182 268) scale(1)'

const applyWorkedClasses = (
  root: HTMLElement | null,
  workedGroups: Set<string>,
  selectedGroups: Set<string>
) => {
  if (!root) return
  const regions = root.querySelectorAll<HTMLElement>('[data-group]')
  regions.forEach((region) => {
    const group = region.getAttribute('data-group')
    if (!group) return
    const inWeek = workedGroups.has(group)
    const inSelected = selectedGroups.has(group)

    region.classList.toggle('worked-week', inWeek && !inSelected)
    region.classList.toggle('worked-selected', inSelected)
  })
}

export default function MuscleMapSvg({
  workedGroups,
  selectedGroups,
  view,
  onToggle,
}: MuscleMapSvgProps) {
  const frontRef = useRef<HTMLDivElement>(null)
  const backRef = useRef<HTMLDivElement>(null)

  useEffect(() => {
    applyWorkedClasses(frontRef.current, workedGroups, selectedGroups)
    applyWorkedClasses(backRef.current, workedGroups, selectedGroups)
  }, [workedGroups, selectedGroups])

  const handleClick = (event: MouseEvent<HTMLDivElement>) => {
    const target = event.target as Element | null
    if (!target) return
    const region = target.closest('[data-group]')
    if (!region) return
    const group = region.getAttribute('data-group')
    if (group) {
      onToggle(group)
    }
  }

  return (
    <div className="muscle-map-grid" data-view={view}>
      <div className="map-panel">
        <p className="map-title">Front</p>
        <div
          ref={frontRef}
          className="muscle-svg-frame"
          role="img"
          aria-label="Front body map"
          onClick={handleClick}
        >
          <svg className="muscle-map" viewBox={FRONT_VIEWBOX} aria-hidden="true">
            <image
              href={FRONT_SVG_URL}
              x="0"
              y="0"
              width="725"
              height="1145"
              className="muscle-image"
              preserveAspectRatio="xMidYMid meet"
            />
            <g className="muscle-region" data-group="Chest" transform={CHEST_TRANSFORM}>
              <path d={CHEST_PATH} />
            </g>
            <g className="muscle-region" data-group="Biceps" transform={BICEPS_TRANSFORM}>
              <path d={BICEPS_PATH_LEFT} />
              <path d={BICEPS_PATH_RIGHT} />
            </g>
            <g className="muscle-region" data-group="Triceps" transform={TRICEPS_TRANSFORM}>
              <path d={TRICEPS_PATH_LEFT} />
              <path d={TRICEPS_PATH_RIGHT} />
            </g>
            <g className="muscle-region" data-group="Shoulder" transform={SHOULDER_FRONT_TRANSFORM}>
              <path d={SHOULDER_FRONT_PATH_LEFT} />
              <path d={SHOULDER_FRONT_PATH_RIGHT} />
            </g>
            <g className="muscle-region" data-group="Back" transform={BACK_MUSCLES_FRONT_TRANSFORM}>
              <path d={BACK_MUSCLES_FRONT_PATH} />
              <path d={BACK_MUSCLES_FRONT_PATH_RIGHT} />
            </g>
            <g className="muscle-region" data-group="Core" transform={CORE_TRANSFORM}>
              <path d={CORE_PATH} />
            </g>
            <g className="muscle-region" data-group="Legs" transform={LEGS_FRONT_TRANSFORM}>
              <path d={LEGS_FRONT_PATH_LEFT} />
              <path d={LEGS_FRONT_PATH_RIGHT} />
            </g>
          </svg>
        </div>
      </div>

      <div className="map-panel">
        <p className="map-title">Back</p>
        <div
          ref={backRef}
          className="muscle-svg-frame"
          role="img"
          aria-label="Back body map"
          onClick={handleClick}
        >
          <svg className="muscle-map" viewBox={BACK_VIEWBOX} aria-hidden="true">
            <image
              href={BACK_SVG_URL}
              x="0"
              y="0"
              width="731"
              height="1135"
              className="muscle-image"
              preserveAspectRatio="xMidYMid meet"
            />
            <g className="muscle-region" data-group="Back" transform={BACK_MUSCLES_TRANSFORM}>
              <path d={BACK_MUSCLES_PATH} />
            </g>
            <g className="muscle-region" data-group="Shoulder" transform={SHOULDER_BACK_TRANSFORM}>
              <path d={SHOULDER_BACK_PATH_LEFT} />
              <path d={SHOULDER_BACK_PATH_RIGHT} />
            </g>
            <g className="muscle-region" data-group="Legs" transform={LEGS_BACK_TRANSFORM}>
              <path d={LEGS_BACK_PATH} />
            </g>
          </svg>
        </div>
      </div>
    </div>
  )
}
